groups:

  - name: "fetch"
    description: "Configure the fetch location"

  - name: "secrets"
    description: "Configure secrets for fetch"

  - name: "template"
    description: "Configure the ytt template"

portals:

  web_portal:
    protocols:
      - "https"
    host:
      - "www.carvel.dev"
    ports:
      - "443"
    path: ""

questions:

  - variable: git
    label: "Fetch using git"
    description: "kapp-controller fetch configuration using git"
    group: "fetch"
    schema:
      type: dict
      required: false
      attrs:

        - variable: enabled
          label: "Enable git configuration"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:

              - variable: repo
                label: "git repository location"
                schema:
                  default: "https://github.com/salt-labs/tanzu"
                  hidden: false
                  required: true
                  type: string

              - variable: branch
                label: "git branch"
                schema:
                  default: "origin/master"
                  hidden: false
                  required: true
                  type: string

              - variable: path
                label: "folder path"
                schema:
                  default: "gitops"
                  editable: true
                  hidden: false
                  required: true
                  type: string

  - variable: imgpkg
    label: "Fetch using imgpkg"
    description: "kapp-controller fetch configuration using imgpkg"
    group: "fetch"
    schema:
      type: dict
      required: false
      attrs:

        - variable: enabled
          label: "Enable imgpkg configuration"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:

  - variable: helm
    label: "Fetch using helm"
    description: "kapp-controller fetch configuration using helm"
    group: "fetch"
    schema:
      type: dict
      required: false
      attrs:

        - variable: enabled
          label: "Enable helm configuration"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:

  - variable: secrets
    label: "Secret configuration"
    description: "Secret configuration for fetch"
    group: "secrets"
    schema:
      type: dict
      required: false
      attrs:

        - variable: enabled
          label: "Enable secrets configuration"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:

              - variable: secretRef
                label: "Secret reference"
                schema:
                  type: dict
                  required: true
                  attrs:

                    - variable: name
                      label: "Secret name"
                      schema:
                        default: gitops
                        editable: false
                        hidden: true
                        type: string

                    - variable: namespace
                      label: "Secret namespace"
                      schema:
                        default: gitops
                        editable: false
                        hidden: true
                        type: string

              - variable: http
                label: "Configure HTTP secrets"
                schema:
                  type: dict
                  required: false
                  attrs:

                    - variable: enabled
                      label: "Enable HTTP secrets"
                      schema:
                        type: boolean
                        default: false
                        show_subquestions_if: true
                        subquestions:

                          - variable: username
                            label: "username"
                            schema:
                              default: ""
                              editable: true
                              hidden: false
                              type: string
                              required: true

                          - variable: password
                            label: "password"
                            schema:
                              default: ""
                              editable: true
                              hidden: false
                              type: string
                              required: true

              - variable: ssg
                label: "Configure SSH secrets"
                schema:
                  type: dict
                  required: false
                  attrs:

                    - variable: enabled
                      label: "Enable SSH secrets"
                      schema:
                        type: boolean
                        default: false
                        show_subquestions_if: true
                        subquestions:

                          - variable: key
                            label: "SSH key"
                            schema:
                              default: ""
                              editable: true
                              hidden: false
                              type: string
                              required: true
